<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lector de Documentos Google</title>
    <style>
        /* [Mantén tus estilos CSS existentes] */
        .hidden { display: none; }
        #errorBox {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 12px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div id="status">Preparando lector...</div>
    <div id="loader" class="loader"></div>
    <div id="errorBox" class="hidden"></div>
    
    <button id="lectorBtn" class="hidden" onclick="iniciarLectura()">
        <b>▶ Escuchar en Voz Alta</b>
    </button>
    
    <div id="contenido"></div>
    
    <p><i>La Bibliateca - de Gustavo Uliarte</i></p>

    <script>
        // 1. Configuración inicial
        const docId = obtenerIdDocumento();
        let vocesDisponibles = [];
        
        // 2. Al cargar la página
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await Promise.all([
                    cargarDocumento(),
                    cargarVoces()
                ]);
                
                document.getElementById('lectorBtn').classList.remove('hidden');
                updateStatus('Listo para leer');
            } catch (error) {
                mostrarError(error.message);
            } finally {
                document.getElementById('loader').classList.add('hidden');
            }
        });

        // 3. Función para obtener el ID del documento
        function obtenerIdDocumento() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');
            
            if (!id || id.length < 30) {
                mostrarError('ID de documento no válido');
                throw new Error
